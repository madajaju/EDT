<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Titolo pagina dinamico -->
    <title>Proteggere la tua pipeline DevOps | Embracing Digital Transformation</title>

    <!-- SEO -->
    <link rel="canonical" href="https://www.embracingdigital.org/it/episodes/edt-46/index.html">
    <meta name="description" content="Nella seconda parte di questo episodio, Darren Pulsipher, Chief Solution Architect di Intel, fornisce consigli pratici per proteggere ogni fase del DevOps pipeline, incluso la protezione dell&amp;#39;hardware e delle pile software con il hardware radice di fiducia, la scansione di sicurezza, i container">
    <meta name="keywords" content="Trasformazione digitale, podcast, interviste, notizie, IA, cybersicurezza, edge computing, gestione dei dati">
    <meta name="author" content="Dr. Darren W. Pulsipher">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Proteggere la tua pipeline DevOps | Embracing Digital Transformation — Interviste, Notizie e Community">
    <meta property="og:description" content="Nella seconda parte di questo episodio, Darren Pulsipher, Chief Solution Architect di Intel, fornisce consigli pratici per proteggere ogni fase del DevOps pipeline, incluso la protezione dell&amp;#39;hardware e delle pile software con il hardware radice di fiducia, la scansione di sicurezza, i container">
    <meta property="og:url" content="https://www.embracingdigital.org/it/episodes/edt-46/index.html">
    <meta property="og:image" content="https://embracingdigital.org/images/logo.png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Proteggere la tua pipeline DevOps | Embracing Digital Transformation — Interviste, Notizie e Community">
    <meta name="twitter:description" content="Nella seconda parte di questo episodio, Darren Pulsipher, Chief Solution Architect di Intel, fornisce consigli pratici per proteggere ogni fase del DevOps pipeline, incluso la protezione dell&amp;#39;hardware e delle pile software con il hardware radice di fiducia, la scansione di sicurezza, i container">
    <meta name="twitter:image" content="https://embracingdigital.org/images/logo.png">

    <!-- Hreflang (alternative) -->
    <link rel="alternate" href="https://embracingdigital.org/it/home/" hreflang="it">
    <link rel="alternate" href="https://embracingdigital.org/de/home/" hreflang="de">
    <link rel="alternate" href="https://embracingdigital.org/fr/home/" hreflang="fr">
    <link rel="alternate" href="https://embracingdigital.org/pt/home/" hreflang="pt">
    <link rel="alternate" href="https://embracingdigital.org/ar/home/" hreflang="ar">
    <link rel="alternate" href="https://embracingdigital.org/ja/home/" hreflang="ja">
    <link rel="alternate" href="https://embracingdigital.org/en/home/" hreflang="en">
    <link rel="alternate" href="https://embracingdigital.org/it/home/" hreflang="x-default">

    <!-- Favicon & Stili -->
    <link rel="icon" href="/images/favicon.ico">
    <link rel="stylesheet" href="/css/styles.css">

    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P4XHVE79DL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-P4XHVE79DL');
    </script>

    <!-- Schema.org: Organization + WebSite -->
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "Abbracciare la Trasformazione Digitale",
            "url": "https://embracingdigital.org/",
            "logo": "https://embracingdigital.org/images/logo.png",
            "sameAs": [
                "https://www.youtube.com/@embracingdigital",
                "https://www.linkedin.com/company/embracing-digital-transformation"
            ]
        }
    </script>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "WebSite",
            "name": "Abbracciare la Trasformazione Digitale",
            "url": "https://embracingdigital.org/",
            "potentialAction": {
                "@type": "SearchAction",
                "target": "https://embracingdigital.org/it/search.html?query={query}",
                "query-input": "required name=query"
            }
        }
    </script>
</head>
<body>

<header role="banner">
    <!-- Logo -->
    <div class="logo-container">
        <a href="/it/home/" aria-label="Home — Abbracciare la Trasformazione Digitale">
            <img src="/images/logo.png" alt="Logo — Abbracciare la Trasformazione Digitale" class="site-icon">
        </a>
    </div>

    <!-- Toggle mobile -->
    <button class="menu-toggle" aria-controls="primary-nav" aria-expanded="false" aria-label="Apri/chiudi menu">☰</button>

    <!-- Navigazione principale -->
    <nav id="primary-nav" aria-label="Principale">
        <ul>
            <li><a href="/it/home/index.html" >Home</a></li>

            <li class="dropdown">
                <a href="/it/shows/index.html" aria-haspopup="true" aria-expanded="false">Programmi</a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none">
                        <a role="menuitem" href="/it/episodes/index.html" aria-label="Interviste — Abbracciare la Trasformazione Digitale">
                            Abbracciare la Trasformazione Digitale
                            <small class="nav-note">Interviste</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="/it/briefs/index.html" aria-label="Notizie — Digitale questa settimana">
                            Digitale questa settimana
                            <small class="nav-note">Notizie</small>
                        </a>
                    </li>
                </ul>
            </li>

            <li><a href="/it/guests/index.html">Ospiti</a></li>
            <li><a href="/it/articles/index.html">Articoli</a></li>

            <!-- Community -->
            <li class="dropdown">
                <a href="/it/community.html" aria-haspopup="true" aria-expanded="false">Community</a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none"><a role="menuitem" href="/it/newsletter.html">Newsletter</a></li>
                    <li role="none"><a role="menuitem" href="https://www.patreon.com/embracingdigital" target="_blank" rel="noopener">Patreon</a></li>
                    <li role="none"><a role="menuitem" href="https://www.linkedin.com/company/embracing-digital-transformation" target="_blank" rel="noopener">Gruppo LinkedIn</a></li>
                </ul>
            </li>

            <li><a href="https://6704f0-2.myshopify.com/" target="_blank" rel="noopener">Shop</a></li>

            <!-- Informazioni -->
            <li class="dropdown">
                <a href="/it/about.html" aria-haspopup="true" aria-expanded="false">Informazioni</a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none"><a role="menuitem" href="/it/about.html">Informazioni sul programma</a></li>
                    <li role="none"><a role="menuitem" href="/it/host.html">Conduttore: Dr. Darren Pulsipher</a></li>
                    <li role="none"><a role="menuitem" href="/it/sponsors/index.html">Sponsorizzazioni e contatti</a></li>
                </ul>
            </li>

            <li><a href="/it/search.html">Cerca</a></li>

            <!-- Lingue -->
            <li class="dropdown">
                <a href="#" aria-haspopup="true" aria-expanded="false">Lingue</a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none"><a role="menuitem" href="/ar/home/index.html">العربية</a></li>
                    <li role="none"><a role="menuitem" href="/de/home/index.html">Deutsch</a></li>
                    <li role="none"><a role="menuitem" href="/en/home/index.html">English</a></li>
                    <li role="none"><a role="menuitem" href="/es/home/index.html">Español</a></li>
                    <li role="none"><a role="menuitem" href="/fr/home/index.html">Français</a></li>
                    <li role="none"><a role="menuitem" href="/it/home/index.html">Italiano</a></li>
                    <li role="none"><a role="menuitem" href="/pt/home/index.html">Português</a></li>
                    <li role="none"><a role="menuitem" href="/ja/home/index.html">日本語</a></li>
                </ul>
            </li>
        </ul>
    </nav>
</header>



<a class="skip-link" href="#main">Skip to content</a>

<nav class="breadcrumbs" aria-label="Breadcrumb">
    <ol>
        <li><a href="../../../it/home/index.html">Home</a></li>
        <li><a href="../../../it/episodes/index.html">Episodes</a></li>
        <li aria-current="page">Episode 46: Securing your DevOps Pipeline</li>
    </ol>
</nav>

<main id="main" role="main">
    <article class="episode-container" itemscope itemtype="https://schema.org/PodcastEpisode">

        <header id="one-episode">
            
                <link itemprop="url" href="https://www.embracingdigital.org/it/episodes/edt-46/index.html">
                <meta itemprop="mainEntityOfPage" content="https://www.embracingdigital.org/it/episodes/edt-46/index.html"/>
            

            <h1 id="episode-title" itemprop="name">
                <span class="episode-number">Episode 46</span>
                <span class="episode-title">Securing your DevOps Pipeline</span>
            </h1>

            <p class="episode-meta">
                
                    <time datetime="2021-04-08" itemprop="datePublished">2021-04-08T00:00:00.000Z</time>
                
                <span itemprop="author" itemscope itemtype="https://schema.org/Person">
          <meta itemprop="name" content="Dr. Darren Pulsipher">
          Hosted by <span class="host-name">Dr. Darren Pulsipher</span>
        </span>
            </p>

            <meta itemprop="episodeNumber" content="46"/>
            <meta itemprop="inLanguage" content="it"/>
        </header>

        
            <section class="video-container" aria-label="Watch the episode"
                     itemprop="associatedMedia" itemscope itemtype="https://schema.org/VideoObject">
                <meta itemprop="name" content="Proteggere la tua pipeline DevOps Video">
                <meta itemprop="embedUrl" content="https://www.youtube.com/embed/url">
                <iframe
                        width="auto"
                        height="auto"
                        src="https://www.youtube.com/embed/url"
                        title="Proteggere la tua pipeline DevOps Video"
                        loading="lazy"
                        referrerpolicy="strict-origin-when-cross-origin"
                        allowfullscreen
                ></iframe>
            </section>
        

        
            <section class="podcast-container" aria-label="Listen to this episode"
                     itemprop="associatedMedia" itemscope itemtype="https://schema.org/AudioObject">
                <meta itemprop="name" content="Proteggere la tua pipeline DevOps Audio">
                <meta itemprop="contentUrl" content="https://share.transistor.fm/e/3abb647c">
                <iframe
                        width="100%"
                        height="180"
                        frameborder="0"
                        scrolling="no"
                        src="https://share.transistor.fm/e/3abb647c"
                        title="Proteggere la tua pipeline DevOps Audio"
                        loading="lazy"
                ></iframe>

                <p class="listen-note">
                    Explore more in the <a href="../../../it/episodes/index.html">episode archive</a>.
                </p>
            </section>
        

        <section class="show-summary" aria-label="Episode summary" itemprop="description">
            <h2>Summary</h2>
            <p>Nella seconda parte di questo episodio, Darren Pulsipher, Chief Solution Architect di Intel, fornisce consigli pratici per proteggere ogni fase del DevOps pipeline, incluso la protezione dell&#39;hardware e delle pile software con il hardware radice di fiducia, la scansione di sicurezza, i container</p>


            
                <nav class="tags" aria-label="Tags">
                    
                        <a href="../../../it/search.html?query=security"
                           itemprop="keywords">security</a>
                    
                        <a href="../../../it/search.html?query=devops"
                           itemprop="keywords">devops</a>
                    
                        <a href="../../../it/search.html?query=hardware_security"
                           itemprop="keywords">hardware_security</a>
                    
                        <a href="../../../it/search.html?query=zerotrust"
                           itemprop="keywords">zerotrust</a>
                    
                        <a href="../../../it/search.html?query=cybersecurity"
                           itemprop="keywords">cybersecurity</a>
                    
                        <a href="../../../it/search.html?query=people"
                           itemprop="keywords">people</a>
                    
                        <a href="../../../it/search.html?query=process"
                           itemprop="keywords">process</a>
                    
                        <a href="../../../it/search.html?query=policy"
                           itemprop="keywords">policy</a>
                    
                        <a href="../../../it/search.html?query=technology"
                           itemprop="keywords">technology</a>
                    
                </nav>
            

            
                <div class="guests" aria-label="Guests">
                    
                        <span itemprop="actor" itemscope itemtype="https://schema.org/Person">
              <a href="../../../it/guests/darren-w-pulsipher/index.html" itemprop="url">
                <span itemprop="name">Darren W Pulsipher</span>
              </a>
            </span>
                    
                </div>
            
        </section>

        <section class="show-notes" aria-label="Show notes">
            <h2>I Vettori di Attacco</h2>
<p>Molti attacchi avvengono a livello individuale delle persone. Alcuni degli attacchi più recenti e subdoli si sono concentrati sul phishing e sull&#39;ingegneria sociale rivolta agli individui all&#39;interno di DevOps. Abbiamo bisogno di addestrare meglio le persone a tutti i livelli. In un caso, è stato uno stagista con accesso alle chiavi che è caduto vittima di un piano malvagio.</p>
<p>Un altro vettore è la tecnologia: attacchi tradizionali di negazione del servizio, attacchi di iniezione SQL o attacchi di andamento dell&#39;overflow. Gli ultimi incidenti utilizzano sia persone che tecnologia per attaccare il processo. Sono insidiosi perché si verificano durante il processo di costruzione e possono essere molto difficili da individuare. Possono anche propagare codice maligno attraverso i clienti. Per instillare fiducia nei clienti, le organizzazioni devono avere una strategia per proteggere la pipeline di fornitura.</p>
<h2>Sicurezza della pipeline</h2>
<p>Non tutte le build pipeline sono uguali, ma in generale, sono composte da quattro fasi con relativi ambienti: sviluppo, compilazione, test e produzione. Queste fasi possono essere facilmente suddivise in più stadi a seconda del tipo di prodotto che stai sviluppando, ma gli ambienti sono collegati a tali diverse fasi.</p>
<p>Dobbiamo analizzare l&#39;intero processo, che comprende software, hardware e procedure, e adottare un approccio diverso anziché concentrarsi solo sull&#39;infrastruttura, come hanno fatto efficacemente la maggior parte.</p>
<h2>Sicurezza del server e dell&#39;infrastruttura</h2>
<p>In fondo alla pila, è necessario proteggere l&#39;hardware nell&#39;ambiente di sviluppo e compilazione. L&#39;ambiente di test sarà un po&#39; diverso perché potresti voler eseguire test che coinvolgono l&#39;iniezione di codice maligno. Gli ambienti di produzione di solito sono ben protetti, specialmente adesso che molte aziende offrono software come servizio. Negli ambienti di produzione e compilazione, devi adottare tutte le misure di sicurezza tipiche che adotteresti negli ambienti di produzione o SaaS.</p>
<p>Ci sono tre elementi chiave in questi ambienti. Il primo è la rilevazione. La rilevazione e la risoluzione dei problemi sono noti come misura di sicurezza utilizzando i registri di servizio che utilizzano una piattaforma come Splunk per trovare qualunque cosa fuori dall&#39;ordinario. Assicurati di farlo non solo negli ambienti di sviluppo, ma anche in quelli di costruzione e produzione.</p>
<p>Tieni presente che nell&#39;ambiente di test avrai bisogno di più ambienti di test, alcuni più sicuri di altri sul lato della rilevazione poiché desideri inserire codice errato nei tuoi test. Non distribuire semplicemente la sicurezza uniformemente in tutti gli ambienti; i profili di sicurezza possono essere diversi per ogni ambiente.</p>
<p>La prevenzione è la seconda chiave. Ciò significa essere attenti con l&#39;hardware, assicurarsi che le cose siano correttamente aggiornate, avere gli aggiornamenti di sicurezza corretti e farlo in modo automatizzato. Questo dovrebbe avvenire in tutte le ambientazioni, inclusa l&#39;ambiente di test, e soprattutto durante la creazione e la produzione.</p>
<p>La terza chiave fa parte della prevenzione: la radice affidabile dell&#39;hardware. Una catena di fiducia può essere stabilita dall&#39;hardware, attraverso le sezioni di avvio del firmware, fino ai supervisori e ai sistemi operativi. La radice della fiducia può essere portata nei contesti di sviluppo, costruzione, test e produzione. Questo può includere contenitori sicuri e macchine virtuali sicure. Ad esempio, mi piace conservare le mie chiavi di crittografia e di hash nell&#39;hardware come un modulo TPM e poi anche con l&#39;estensione Secure Guard di Intel. Anche se qualcuno accedesse alla macchina, non sarebbe in grado di rubare quelle chiavi.</p>
<h2>Eseguibili affidabili</h2>
<p>L&#39;impostazione degli eseguibili fidati è il passaggio successivo. Ciò significa che puoi eseguire controlli di sicurezza sul codice che viene controllato e compilato e quindi effettuare il check-in con l&#39;hash delle modifiche apportate. Se è stato inserito qualcosa nella base del codice, puoi rilevarlo, poiché non dovrebbero esserci modifiche al codice durante il processo di compilazione.</p>
<p>In una nuova fase di controlli di sicurezza, è possibile eseguire l&#39;analisi statica del codice o l&#39;analisi dinamica del codice o violazioni di sicurezza. Ci sono alcuni ottimi strumenti che è possibile integrare facilmente nel proprio tipico flusso di lavoro DevOps, sia che si utilizzi Jenkins o i flussi di lavoro di GitHub, ad esempio.</p>
<p>Una volta che un eseguibile è stato costruito, crea immediatamente l&#39;hash e quel hash dovrebbe essere versionato con l&#39;eseguibile; dovrebbe rimanere l&#39;eseguibile che viene sottoposto a tutti i test e spinto in produzione. Quell&#39;hash garantirà che nulla sia stato manomesso.</p>
<h2>Immagini attestata e sicure.</h2>
<p>Solitamente, ci sono diversi repository o eseguibili da utilizzare per il codice. L&#39;hash che viene creato durante la compilazione è ora nel registro e puoi attestarlo. Puoi proteggere quelli nelle immagini in modo che non possano essere modificati. Se qualcuno ha bisogno di tornare indietro e apportare una piccola modifica, ad esempio una etichetta o metadati, è importante non apportare la modifica e darle lo stesso numero di versione. È meglio passare di nuovo attraverso il ciclo, anche se ci vuole più tempo che avere processi manuali che si intromettono nei tuoi binari.</p>
<p>Ora, puoi prendere lo stesso binario su cui hai eseguito tutti i test e spingerlo in produzione. A questo punto, è un errore ricostruire il codice sorgente. È meglio spingere la build originale nel repository di produzione, o dorato. Questo repository è l&#39;unico luogo da cui recuperare immagini, binari o macchine virtuali, ad esempio. Tutte le immagini devono essere notarizzate e certificate. Se hai macchine virtuali o applicazioni confidenziali, o desideri assicurarti che finiscano solo su hardware specifico, puoi impostare questo tipo di restrizioni. Puoi crittografare le macchine virtuali, i contenitori o persino i binari e bloccarli con la chiave che è memorizzata nei tuoi sistemi di build e produzione.</p>
<h2>Iniettare Strumenti di Sicurezza</h2>
<p>Gli strumenti di sicurezza devono essere integrati nel processo di costruzione. Invece di prendere liberamente librerie di sicurezza open source o ricreare quelle già esistenti, i tuoi ingegneri della sicurezza dovrebbero essere coinvolti in modo che possano scegliere strumenti che possano essere facilmente utilizzati e riutilizzati dai team di sviluppo. Un buon esempio è l&#39;autenticazione di base: il login dell&#39;utente. Dovrebbe esistere una libreria comune anziché ogni applicazione avere la propria.</p>
<p>È importante trattare queste librerie di sicurezza e strumenti proprio come faresti con qualsiasi altro programma di sviluppo software che stai condividendo all&#39;interno della tua organizzazione. La condivisione ridurrà i tempi e aumenterà la sicurezza in tutto il tuo ecosistema.</p>
<h2>Costruisci una volta, distribuisci sicurezza ovunque.</h2>
<p>Una volta che hai istituito i tuoi team di sicurezza degli sviluppatori, assicurati di iniettare le politiche e gli strumenti in tutti i tuoi prodotti e ambienti. Oggi esistono delle ottime tecnologie che ti consentono di gestire più ambienti. Quindi, quando viene creato un nuovo applicativo, viene creato con un profilo di sicurezza usando le tue immagini di macchine virtuali o contenitori come immagini di base utilizzate dai team di sviluppo. Configurando la sicurezza nelle tue VM o contenitori nelle immagini di base, otterrai una conformità istantanea su diversi ambienti. È inoltre possibile integrarsi con strumenti di sicurezza, in modo che se si trova qualcosa di insolito nell&#39;applicazione, è possibile notificarlo agli strumenti di sicurezza. Non cercare di creare strumenti di sicurezza che gestiscano il cento per cento dei casi, perché non li finiresti mai; punta all&#39;ottanta percento come base solida e creali in modo che gli sviluppatori possano innovare l&#39;ultimo venti percento se necessario, in collaborazione con il tuo team di sicurezza.</p>
<p>Un ultimo consiglio importante è automatizzare tutto ciò che puoi, soprattutto nel processo DevOps, per prevenire iniezioni maliziose. Proteggi la tua pipeline; proteggi il tuo processo.</p>

        </section>

        

    </article>
</main>

<!-- Structured Data -->
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "PodcastSeries",
  "@id": "https://www.embracingdigital.org/it/episodes/index.html#series",
  "name": "Embracing Digital Transformation",
  "url": "https://www.embracingdigital.org/it/episodes/index.html",
  "inLanguage": "it",
  "description": "A podcast about the digital transformation of the world.",
  "publisher": {
    "@type": "Organization",
    "@id": "https://www.embracingdigital.org/#org",
    "name": "Embracing Digital Transformation",
    "url": "https://www.embracingdigital.org",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.embracingdigital.org/images/logo.png",
      "width": 512,
      "height": 512
    }
  }
}</script>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "PodcastEpisode",
  "@id": "https://www.embracingdigital.org/it/episodes/edt-46/index.html#episode",
  "url": "https://www.embracingdigital.org/it/episodes/edt-46/index.html",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.embracingdigital.org/it/episodes/edt-46/index.html"
  },
  "name": "Proteggere la tua pipeline DevOps",
  "episodeNumber": 46,
  "datePublished": "2021-04-08",
  "inLanguage": "it",
  "description": "Nella seconda parte di questo episodio, Darren Pulsipher, Chief Solution Architect di Intel, fornisce consigli pratici per proteggere ogni fase del DevOps pipeline, incluso la protezione dell&#39;hardware e delle pile software con il hardware radice di fiducia, la scansione di sicurezza, i container",
  "partOfSeries": {
    "@id": "https://www.embracingdigital.org/it/episodes/index.html#series"
  },
  "author": {
    "@type": "Person",
    "name": "Dr. Darren Pulsipher"
  },
  "creator": {
    "@type": "Person",
    "name": "Dr. Darren Pulsipher"
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://www.embracingdigital.org/it/episodes/edt-46/thumbnail.png"
  },
  "associatedMedia": [
    {
      "@type": "VideoObject",
      "name": "Proteggere la tua pipeline DevOps Video",
      "embedUrl": "https://www.youtube.com/embed/url"
    },
    {
      "@type": "AudioObject",
      "name": "Proteggere la tua pipeline DevOps Audio",
      "contentUrl": "https://share.transistor.fm/e/3abb647c"
    }
  ],
  "actor": [
    {
      "@type": "Person",
      "name": "Darren W Pulsipher",
      "url": "https://www.embracingdigital.org/../../../it/guests/darren-w-pulsipher/index.html"
    }
  ]
}</script>

<footer id="footer">
    <div class="footer-content">
        <p>Copyright &copy; 2025 Paidar Productions LLC</p>
        <p>Diritti riservati</p>
    </div>
</footer>
<script>
    // year
    (function(){ var y=document.getElementById('y'); if(y){ y.textContent = new Date().getFullYear(); } })();

    // Guard for pages without nav
    const toggle = document.querySelector('.menu-toggle');
    const nav    = document.querySelector('nav#primary-nav');
    if (nav) {
        // Mobile: toggle .menu-open on <body>
        toggle?.addEventListener('click', () => {
            const open = document.body.classList.toggle('menu-open');
            toggle.setAttribute('aria-expanded', String(open));
        });

        // Dropdowns: tap/click + keyboard
        document.querySelectorAll('li.dropdown > a').forEach(link => {
            const li = link.parentElement;
            const submenu = li.querySelector('.dropdown-menu');

            link.addEventListener('click', (e) => {
                if (!submenu) return;
                e.preventDefault();

                // close others
                document.querySelectorAll('li.dropdown.open > a').forEach(a => {
                    if (a !== link) {
                        a.setAttribute('aria-expanded', 'false');
                        a.parentElement.classList.remove('open');
                    }
                });

                const isOpen = li.classList.toggle('open');
                link.setAttribute('aria-expanded', String(isOpen));
            });

            link.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowDown') { e.preventDefault(); submenu?.querySelector('a')?.focus(); }
                if (e.key === 'Escape')    { li.classList.remove('open'); link.setAttribute('aria-expanded','false'); link.focus(); }
            });
        });

        // Close dropdowns on outside click
        document.addEventListener('click', (e) => {
            if (!e.target.closest('nav')) {
                document.querySelectorAll('li.dropdown.open > a').forEach(a => {
                    a.setAttribute('aria-expanded','false');
                    a.parentElement.classList.remove('open');
                });
            }
        });
    }
</script>

