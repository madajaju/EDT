<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <base href="https://embracingdigital.org/" />

    <!-- Robots -->
    <meta name="robots" content="index, follow">

    <!-- Dynamic Title / Meta -->
    <title>Elastic Search &amp; Intel Optane DCPMM | Embracing Digital Transformation</title>
    <meta name="description" content="Darren Pulsipher shows how he increased Elasticsearch performance using Intel%92s Optane Persistent Memory in 100 percent app direct mode. His tests show an incredible performance increase of 2x. By doubling the throughput capacity, you can greatly decrease the number of servers in your Elasticsearc">
    
    
    <link rel="canonical" href="https://www.embracingdigital.org/en/episodes/edt-17/index.html">
    

    <!-- Hreflang alternates (optional: pass `langs` into the template) -->
    

    <!-- Preconnect & CSS -->
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="stylesheet" href="css/styles.css">

    <!-- Favicon -->
    <link rel="icon" href="images/favicon.ico" sizes="32x32" type="image/x-icon">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Elastic Search &amp; Intel Optane DCPMM | Embracing Digital Transformation">
    <meta property="og:description" content="Darren Pulsipher shows how he increased Elasticsearch performance using Intel%92s Optane Persistent Memory in 100 percent app direct mode. His tests show an incredible performance increase of 2x. By doubling the throughput capacity, you can greatly decrease the number of servers in your Elasticsearc">
    <meta property="og:url" content="https://www.embracingdigital.org/en/episodes/edt-17/index.html">
    <meta property="og:image" content="https://embracingdigital.org/images/logo.png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Elastic Search &amp; Intel Optane DCPMM | Embracing Digital Transformation">
    <meta name="twitter:description" content="Darren Pulsipher shows how he increased Elasticsearch performance using Intel%92s Optane Persistent Memory in 100 percent app direct mode. His tests show an incredible performance increase of 2x. By doubling the throughput capacity, you can greatly decrease the number of servers in your Elasticsearc">
    <meta name="twitter:image" content="https://embracingdigital.org/images/logo.png">

    <!-- Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P4XHVE79DL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){ dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-P4XHVE79DL');
    </script>

    <!-- Schema.org -->
    <script type="application/ld+json">
        {
            "@context":"https://schema.org",
            "@type":"Organization",
            "name":"Embracing Digital Transformation",
            "url":"https://embracingdigital.org/",
            "logo":"https://embracingdigital.org/images/logo.png",
            "sameAs":[
                "https://www.youtube.com/@embracingdigital",
                "https://www.linkedin.com/company/embracingdigital"
            ]
        }
    </script>
    <script type="application/ld+json">
        {
            "@context":"https://schema.org",
            "@type":"WebSite",
            "name":"Embracing Digital Transformation",
            "url":"https://embracingdigital.org/",
            "potentialAction":{
                "@type":"SearchAction",
                "target":"https://embracingdigital.org/en/search.html?query={query}",
                "query-input":"required name=query"
            }
        }
    </script>
</head>

<body>
<header class="site-header" role="banner">
    <div class="header-inner">
        <!-- Brand -->
        <div class="brand">
            <a class="brand-link" href="en/home/index.html" aria-label="Embracing Digital home">
                <img src="/images/logo.png" alt="Embracing Digital Transformation logo" class="site-icon">
                <span class="brand-text">
            </a>
        </div>
    </div>

    <nav id="primary-nav" aria-label="Primary">
        <!-- Main nav (left) -->
        <ul class="nav-main">
            <li>
                <a href="en/home/index.html"
                >
                Home
                </a>
            </li>

            <!-- Guidance (Shows / weekly arc) -->
            <li class="dropdown">
                <a href="en/shows/index.html"
                   aria-haspopup="true"
                   aria-expanded="false"
                >
                Guidance
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none">
                        <a role="menuitem" href="en/briefs/index.html">
                            Briefings (EDTW)
                            <small class="nav-note">What changed</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/episodes/index.html">
                            Interviews (EDT)
                            <small class="nav-note">How others did it</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/briefs/deepdives.html">
                            Architectural Deep Dives
                            <small class="nav-note">What to do next</small>
                        </a>
                    </li>
                </ul>
            </li>

            <!-- Learn (Documentation / learning library) -->
            <li class="dropdown">
                <a href="en/digital-transformation/index.html"
                   aria-haspopup="true"
                   aria-expanded="false"
                >
                Learn
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none">
                        <a role="menuitem" href="en/digital-transformation/index.html">
                            Digital Transformation
                            <small class="nav-note">Overview</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/digital-transformation/pillars/index.html">
                            Pillars
                            <small class="nav-note">AI, Cyber, Data, Edge, Computing, Comms</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/digital-transformation/odxa/index.html">
                            ODXA
                            <small class="nav-note">Domains &amp; mappings</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/digital-transformation/whitepapers/index.html">
                            Whitepapers
                            <small class="nav-note">Monthly canonical synthesis</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/digital-transformation/articles/index.html">
                            Articles
                            <small class="nav-note">Explainers &amp; analysis</small>
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="en/lectures/index.html">
                            Lectures (DTA)
                            <small class="nav-note">Learning series</small>
                        </a>
                    </li>
                </ul>
            </li>

            <!-- Community -->
            <li class="dropdown">
                <a href="en/community.html"
                   aria-haspopup="true"
                   aria-expanded="false"
                >
                Community
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none"><a role="menuitem" href="en/community.html">Community</a></li>
                    <li role="none"><a role="menuitem" href="en/newsletter.html">Newsletter</a></li>
                    <li role="none">
                        <a role="menuitem" href="https://www.patreon.com/embracingdigital" target="_blank" rel="noopener">
                            Patreon
                        </a>
                    </li>
                    <li role="none">
                        <a role="menuitem" href="https://www.linkedin.com/company/embracing-digital-transformation" target="_blank" rel="noopener">
                            LinkedIn
                        </a>
                    </li>
                </ul>
            </li>

            <!-- About (also holds Sponsors + Shop to keep top-level count low) -->
            <li class="dropdown">
                <a href="en/about.html"
                   aria-haspopup="true"
                   aria-expanded="false"
                >
                About
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none"><a role="menuitem" href="en/about.html">About</a></li>
                    <li role="none"><a role="menuitem" href="en/host.html">Host</a></li>
                    <li role="none"><a role="menuitem" href="en/sponsors/index.html">Sponsors</a></li>
                    <li role="none"><a role="menuitem" href="https://6704f0-2.myshopify.com/" target="_blank" rel="noopener">Shop</a></li>
                </ul>
            </li>

            <!-- Search -->
            <li>
                <a href="en/search.html"
                >
                Search
                </a>
            </li>
        </ul>

        <!-- Right side (Languages) -->
        <ul class="nav-right">
            <li class="dropdown">
                <a href="#" aria-haspopup="true" aria-expanded="false" aria-label="Select language">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle;">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="2" y1="12" x2="22" y2="12"></line>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li role="none"><a role="menuitem" href="ar/home/index.html">العربية</a></li>
                    <li role="none"><a role="menuitem" href="de/home/index.html">Deutsch</a></li>
                    <li role="none"><a role="menuitem" href="en/home/index.html">English</a></li>
                    <li role="none"><a role="menuitem" href="fr/home/index.html">Français</a></li>
                    <li role="none"><a role="menuitem" href="it/home/index.html">Italiano</a></li>
                    <li role="none"><a role="menuitem" href="pt/home/index.html">Português</a></li>
                    <li role="none"><a role="menuitem" href="ja/home/index.html">日本語</a></li>
                </ul>
            </li>
        </ul>
    </nav>
</header>



<a class="skip-link" href="#main">Skip to content</a>

<nav class="breadcrumbs" aria-label="Breadcrumb">
    <ol>
        <li><a href="../../../en/home/index.html">Home</a></li>
        <li><a href="../../../en/episodes/index.html">Episodes</a></li>
        <li aria-current="page">Episode 17: Elastic Search &amp; Intel Optane DCPMM</li>
    </ol>
</nav>

<main id="main" role="main">
    <article class="episode-container" itemscope itemtype="https://schema.org/PodcastEpisode">

        <header id="one-episode">
            
                <link itemprop="url" href="https://www.embracingdigital.org/en/episodes/edt-17/index.html">
                <meta itemprop="mainEntityOfPage" content="https://www.embracingdigital.org/en/episodes/edt-17/index.html"/>
            

            <h1 id="episode-title" itemprop="name">
                <span class="episode-number">Episode 17</span>
                <span class="episode-title">Elastic Search &amp; Intel Optane DCPMM</span>
            </h1>

            <p class="episode-meta">
                
                    <time datetime="2020-08-31" itemprop="datePublished">2020-08-31T00:00:00.000Z</time>
                
                <span itemprop="author" itemscope itemtype="https://schema.org/Person">
          <meta itemprop="name" content="Dr. Darren Pulsipher">
          Hosted by <span class="host-name">Dr. Darren Pulsipher</span>
        </span>
            </p>

            <meta itemprop="episodeNumber" content="17"/>
            <meta itemprop="inLanguage" content="en"/>
        </header>

        
            <section class="video-container" aria-label="Watch the episode"
                     itemprop="associatedMedia" itemscope itemtype="https://schema.org/VideoObject">
                <meta itemprop="name" content="Elastic Search & Intel Optane DCPMM Video">
                <meta itemprop="embedUrl" content="https://www.youtube.com/embed/url">
                <iframe
                        width="auto"
                        height="auto"
                        src="https://www.youtube.com/embed/url"
                        title="Elastic Search & Intel Optane DCPMM Video"
                        loading="lazy"
                        referrerpolicy="strict-origin-when-cross-origin"
                        allowfullscreen
                ></iframe>
            </section>
        

        
            <section class="podcast-container" aria-label="Listen to this episode"
                     itemprop="associatedMedia" itemscope itemtype="https://schema.org/AudioObject">
                <meta itemprop="name" content="Elastic Search & Intel Optane DCPMM Audio">
                <meta itemprop="contentUrl" content="https://share.transistor.fm/e/77870513">
                <iframe
                        width="100%"
                        height="180"
                        frameborder="0"
                        scrolling="no"
                        src="https://share.transistor.fm/e/77870513"
                        title="Elastic Search & Intel Optane DCPMM Audio"
                        loading="lazy"
                ></iframe>

                <p class="listen-note">
                    Explore more in the <a href="../../../en/episodes/index.html">episode archive</a>.
                </p>
            </section>
        

        <section class="show-summary" aria-label="Episode summary" itemprop="description">
            <h2>Summary</h2>
            <p>Darren Pulsipher shows how he increased Elasticsearch performance using Intel%92s Optane Persistent Memory in 100 percent app direct mode. His tests show an incredible performance increase of 2x. By doubling the throughput capacity, you can greatly decrease the number of servers in your Elasticsearc</p>


            
                <nav class="tags" aria-label="Tags">
                    
                        <a href="../../../en/search.html?query=intel"
                           itemprop="keywords">intel</a>
                    
                        <a href="../../../en/search.html?query=optane"
                           itemprop="keywords">optane</a>
                    
                        <a href="../../../en/search.html?query=moderncomputing"
                           itemprop="keywords">moderncomputing</a>
                    
                        <a href="../../../en/search.html?query=dataanalytics"
                           itemprop="keywords">dataanalytics</a>
                    
                        <a href="../../../en/search.html?query=multicloud"
                           itemprop="keywords">multicloud</a>
                    
                        <a href="../../../en/search.html?query=process"
                           itemprop="keywords">process</a>
                    
                        <a href="../../../en/search.html?query=technology"
                           itemprop="keywords">technology</a>
                    
                </nav>
            

            
                <div class="guests" aria-label="Guests">
                    
                        <span itemprop="actor" itemscope itemtype="https://schema.org/Person">
              <a href="../../../en/guests/darren-w-pulsipher/index.html" itemprop="url">
                <span itemprop="name">Darren W Pulsipher</span>
              </a>
            </span>
                    
                </div>
            
        </section>

        <section class="show-notes" aria-label="Show notes">
            <p>Recently, I ran some tests with Intel’s new technology called Optane DC Persistent Memory (PMEM) with Kafka. By using Optane in a non-traditional way, mounted as a file system, I was able to get a massive improvement in throughput. Check out my podcast about it here. (can you put a link here?) I tried the same thing with Elasticsearch to see if I could achieve similar performance improvement.</p>
<p>Elasticsearch is a highly scalable search and analytics engine that allows for the distribution of data across multiple nodes to scale out the solution and support more substantial amounts of data. In other words, it is a distributed metadata manager, primarily used to do log analysis. Elastic itself is a great tool for normalizing data into JSON format. I can push any kind of data into Elastic and it can span over a distributive cluster. It is not a message bus like Kafka, but instead, indexes the data you have coming in. Since Elastic is storing this data on drives, I realized I could use the PMEM in the same way that I did with Kafka.</p>
<h2>Intel Optane DC Persistent Memory</h2>
<p>Intel Optane DC Persistent Memory comes in DDR4 format, so it fits right in your server in a DDR4 memory slot. The modules come in 128, 256, and 512 gigabytes, so in a two-socket system, I can have 6 terabytes of PMEM. One important feature is that the hardware is encrypted and tied to your CPU with that encryption, so it’s secure and highly reliable. It is already being used to make some profound changes in the way it’s being used in tools in a lot of databases, such as in Oracle’s Exadata platform as well as SAP HANA.</p>
<h2>Support for Breadth of Applications</h2>
<p>There are several ways to use this technology:</p>
<p>The first is memory mode, which extends the footprint of a server. It uses the PMEM just like normal memory. The DDR4 memory acts as a cache to the PMEM. In this mode, the speed is comparable to DDR4; in most applications, you won’t see a change.</p>
<p>The second mode is app direct. In app direct mode, I can write an application so that it writes directly into PMEM, bypassing time-consuming steps.</p>
<p>The third mode is using app direct mode to create a non-volatile memory file system that sits right on the memory bus, which is many times faster than the NVMe bus or even the SATA bus.</p>
<p>Using this third mode, I had to learn a bit about the architecture of Elastic to find out which parts I should run in this ultra-fast file system and which I should leave where they are. I also wanted to know if I could make those changes with just the configuration file.</p>
<h2>Using Linux Kernel</h2>
<p>First, I had to learn how to use the Linux kernel commands for manipulating this PMEM.</p>
<p>With the Intel persistent memory control (ipmctl) command, I found I could configure and manage the PMEM so that I could allocate it to run in memory mode, app direct mode, or a percentage in memory mode.</p>
<p>The other command is non-volatile memory device control (ndctl). This allows me to create namespaces and regions in that PMEM I created, so I can mount that region as a device. Then I can mount that device as a file system.</p>
<h2>ESRally Performance Testing</h2>
<p>I found ESRally, a benchmark tool, to use in my tests. The first time I set up the test, I ran ESRally from my normal SATA drive, where Elastic was running everything out of the PMEM drive. I got some performance improvement, but what I found was that because I was streaming data off the SATA drive that was stored in my ESRally, I was limited by how fast I could push data into Elasticsearch. So it wasn’t Elastic that was slowing down, it was ESRally because my SATA drive was so much slower than my PMEM drive. I moved ESRally onto the PMEM drive. This improved the performance, and I got some interesting results.</p>
<h2>Testing Constraints</h2>
<p>To see what the effects of this PMEM ultra-fast drive would be on Elastic, I ran the test on one machine. This removed network variability which eliminated network bottlenecks as a limiting factor. I decreased inter-service communication, which reduced replica bottlenecks, and ran all inquiries on PMEMs which eliminated the variability of the SATA drive.</p>
<h2>Optimal Performance (100%) App Direct</h2>
<p>First, I allocated all of the PMEM to app direct mode so I could mount the whole thing as a file system. I used 128 gigabyte DIMMS, so I had a drive with 1.5 terabytes I could use. I knew from my previous test with Kafka that I get better performance with 100% app direct mode rather than 50%.</p>
<p>Median Thru put (should be Throughput – might want to change on slide) docs/sec</p>
<p>Using the ESRally statistics, I took the median throughput on documents per second compared to the number of concurrent races I was running at the same time with producers and consumers.  I got some good numbers with the SATA drive, comparable to other published tests. With the PMEM Drive, I was able to ingest almost twice as many documents per second. This is pretty incredible considering there were no changes to code, just a configuration change.</p>
<h2>Service Response Time</h2>
<p>The other result was response times to functions. As expected, as the number of concurrent races running at the same time increases, the response time to those queries or functions goes up. But with the PMEM, the response time is almost twice as fast. From this simple test, I learned that where you are storing the data that Elasticsearch needs (PMEM or SATA) does have an effect on response time.</p>
<h2>Conclusion</h2>
<p>Using Optane Persistent Memory in file system mode to increase performance and decrease costs of Elasticsearch servers requires minimal hardware and software configuration changes and no changes to Elasticsearch or underlying applications. Doubling your throughput capacity of Elasticsearch means you can decrease the total number of servers in your Elasticsearch cluster, reducing your total cost of ownership.</p>
<h2>For More Information</h2>
<p>For more detailed information, check out the link in the podcast to the document that we created in response to these test results. You can also contact me at <a href="mailto:darren.w.pulsipher@intel.com">darren.w.pulsipher@intel.com</a> or on LinkedIn @darrenpulsipher.</p>

        </section>

        

    </article>
</main>

<!-- Structured Data -->
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "PodcastSeries",
  "@id": "https://www.embracingdigital.org/en/episodes/index.html#series",
  "name": "Embracing Digital Transformation",
  "url": "https://www.embracingdigital.org/en/episodes/index.html",
  "inLanguage": "en",
  "description": "A podcast about the digital transformation of the world.",
  "publisher": {
    "@type": "Organization",
    "@id": "https://www.embracingdigital.org/#org",
    "name": "Embracing Digital Transformation",
    "url": "https://www.embracingdigital.org",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.embracingdigital.org/images/logo.png",
      "width": 512,
      "height": 512
    }
  }
}</script>
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "PodcastEpisode",
  "@id": "https://www.embracingdigital.org/en/episodes/edt-17/index.html#episode",
  "url": "https://www.embracingdigital.org/en/episodes/edt-17/index.html",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.embracingdigital.org/en/episodes/edt-17/index.html"
  },
  "name": "Elastic Search & Intel Optane DCPMM",
  "episodeNumber": 17,
  "datePublished": "2020-08-31",
  "inLanguage": "en",
  "description": "Darren Pulsipher shows how he increased Elasticsearch performance using Intel%92s Optane Persistent Memory in 100 percent app direct mode. His tests show an incredible performance increase of 2x. By doubling the throughput capacity, you can greatly decrease the number of servers in your Elasticsearc",
  "partOfSeries": {
    "@id": "https://www.embracingdigital.org/en/episodes/index.html#series"
  },
  "author": {
    "@type": "Person",
    "name": "Dr. Darren Pulsipher"
  },
  "creator": {
    "@type": "Person",
    "name": "Dr. Darren Pulsipher"
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://www.embracingdigital.org/en/episodes/edt-17/thumbnail.png"
  },
  "associatedMedia": [
    {
      "@type": "VideoObject",
      "name": "Elastic Search & Intel Optane DCPMM Video",
      "embedUrl": "https://www.youtube.com/embed/url"
    },
    {
      "@type": "AudioObject",
      "name": "Elastic Search & Intel Optane DCPMM Audio",
      "contentUrl": "https://share.transistor.fm/e/77870513"
    }
  ],
  "actor": [
    {
      "@type": "Person",
      "name": "Darren W Pulsipher",
      "url": "https://www.embracingdigital.org/../../../en/guests/darren-w-pulsipher/index.html"
    }
  ]
}</script>

<footer id="footer">
    <div class="footer-content">
        <p>Copyright &copy; <span id="y"></span> Paidar Productions LLC</p>
        <p>All rights reserved</p>
    </div>
</footer>

<script>
    // year
    (function(){ var y=document.getElementById('y'); if(y){ y.textContent = new Date().getFullYear(); } })();

    // Guard for pages without nav
    const toggle = document.querySelector('.menu-toggle');
    const nav    = document.querySelector('nav#primary-nav');
    if (nav) {
        // Mobile: toggle .menu-open on <body>
        toggle?.addEventListener('click', () => {
            const open = document.body.classList.toggle('menu-open');
            toggle.setAttribute('aria-expanded', String(open));
        });

        // Dropdowns: tap/click + keyboard
        document.querySelectorAll('li.dropdown > a').forEach(link => {
            const li = link.parentElement;
            const submenu = li.querySelector('.dropdown-menu');

            link.addEventListener('click', (e) => {
                if (!submenu) return;
                e.preventDefault();

                // close others
                document.querySelectorAll('li.dropdown.open > a').forEach(a => {
                    if (a !== link) {
                        a.setAttribute('aria-expanded', 'false');
                        a.parentElement.classList.remove('open');
                    }
                });

                const isOpen = li.classList.toggle('open');
                link.setAttribute('aria-expanded', String(isOpen));
            });

            link.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowDown') { e.preventDefault(); submenu?.querySelector('a')?.focus(); }
                if (e.key === 'Escape')    { li.classList.remove('open'); link.setAttribute('aria-expanded','false'); link.focus(); }
            });
        });

        // Close dropdowns on outside click
        document.addEventListener('click', (e) => {
            if (!e.target.closest('nav')) {
                document.querySelectorAll('li.dropdown.open > a').forEach(a => {
                    a.setAttribute('aria-expanded','false');
                    a.parentElement.classList.remove('open');
                });
            }
        });
    }
</script>

