<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- T√≠tulo da P√°gina Din√¢mico -->
        <title>Abra√ßando a Transforma√ß√£o Digital</title>

        <!-- Meta Descri√ß√£o para SEO -->
        <meta name="description" content="&lt;p&gt;Neste epis√≥dio, Darren fala sobre diminuir a congest√£o de ingest√£o usando a Mem√≥ria Persistente Optane DC da Intel e o experimento que ele conduziu com resultados surpreendentes. Isso pode mudar a maneira como pensamos sobre programa√ß√£o no futuro.&lt;/p&gt;
">

        <!-- Palavras-chave para SEO -->
        <meta name="keywords" content="podcast, ai, computa√ß√£o de borda, ciberseguran√ßa, transforma√ß√£o digital">

        <!-- Meta do Autor -->
        <meta name="author" content="Darren W Pulsipher">

        <!-- Tags Meta do Open Graph para M√≠dias Sociais -->
        <meta property="og:title" content="Abra√ßando a Transforma√ß√£o Digital">
        <meta property="og:description" content="&lt;p&gt;Neste epis√≥dio, Darren fala sobre diminuir a congest√£o de ingest√£o usando a Mem√≥ria Persistente Optane DC da Intel e o experimento que ele conduziu com resultados surpreendentes. Isso pode mudar a maneira como pensamos sobre programa√ß√£o no futuro.&lt;/p&gt;
">
        <meta property="og:image" content="thumbnail.png">

        <meta property="og:url" content="https://embracingdigital.org">
        <meta property="og:type" content="website">

        <!-- Tags Meta do Twitter Card -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="Abra√ßando a Transforma√ß√£o Digital">
        <meta name="twitter:description" content="&lt;p&gt;Neste epis√≥dio, Darren fala sobre diminuir a congest√£o de ingest√£o usando a Mem√≥ria Persistente Optane DC da Intel e o experimento que ele conduziu com resultados surpreendentes. Isso pode mudar a maneira como pensamos sobre programa√ß√£o no futuro.&lt;/p&gt;
">
        <meta name="twitter:image" content="thumbnail.png">

    <title>Abra√ßando a Transforma√ß√£o Digital</title>

    <link rel="stylesheet" href="../../../css/styles.css">
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-P4XHVE79DL"></script>
    <script> window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'G-P4XHVE79DL'); </script>
</head>
<body>

<!-- üåç Barra de Navega√ß√£o -->
<header>
    <div class="logo-container">
        <img src="../../../images/logo.png" alt="Abra√ßando a Transforma√ß√£o Digital" class="site-icon">
    </div>
    <nav>
        <ul>
            <li><a href="../../../pt/home/index.html">In√≠cio</a></li>
            <li><a href="../../../pt/about.html">Sobre</a></li>
            <li><a href="../../../pt/episodes/index.html">Entrevistas</a></li>
            <li><a href="../../../pt/briefs/index.html">Not√≠cias</a></li>
            <li><a href="../../../pt/community.html">Comunidade</a></li>
            <li><a href="../../../pt/guests/index.html">Convidados</a></li>
            <li><a href="https://6704f0-2.myshopify.com/">Loja</a></li>
            <li><a href="../../../pt/search.html">Buscar</a></li>
            <li class="dropdown">
                <a href="#">Idiomas</a>
                <ul class="dropdown-menu">
                    <li><a href="../../../ar/home/index.html">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a></li> <!-- √Årabe -->
                    <li><a href="../../../de/home/index.html">Deutsch</a></li> <!-- Alem√£o -->
                    <li><a href="../../../en/home/index.html">English</a></li> <!-- Ingl√™s -->
                    <li><a href="../../../fr/home/index.html">Fran√ßais</a></li> <!-- Franc√™s -->
                    <li><a href="../../../it/home/index.html">Italiano</a></li> <!-- Italiano -->
                    <li><a href="../../../pt/home/index.html">Portugu√™s</a></li> <!-- Portugu√™s -->
                    <li><a href="../../../ja/home/index.html">Êó•Êú¨Ë™û</a></li> <!-- Japon√™s -->
                </ul>
            </li>
        </ul>
    </nav>
</header>
<section id="one-episode">
    <h1 id="episode-title">#16 Reduzindo a congest√£o de ingest√£o com o Intel Optane DCPMM</h1>
    <div class="episode-container">
        <!-- YouTube Video Section -->
        <div class="video-container">
            <iframe width="auto" height="auto" src="https://www.youtube.com/embed/url?autoplay=1" title="Episode Playback"></iframe>
        </div>

        <!-- Podcast Audio Section -->
        <div class="podcast-container">
            <iframe width="100%" height="180" frameborder="no" scrolling="no" seamless="" src="https://share.transistor.fm/e/7ca179aa"></iframe>
        </div>
        <div class="show-summary">
            <p><p>Neste epis√≥dio, Darren fala sobre diminuir a congest√£o de ingest√£o usando a Mem√≥ria Persistente Optane DC da Intel e o experimento que ele conduziu com resultados surpreendentes. Isso pode mudar a maneira como pensamos sobre programa√ß√£o no futuro.</p>
</p>

            <!-- Tags Section -->
            <div class="tags">
                
                    <a href="../../../pt/search.html?query=artificialintelligence"><span>artificialintelligence</span></a>
                
                    <a href="../../../pt/search.html?query=machinelearning"><span>machinelearning</span></a>
                
                    <a href="../../../pt/search.html?query=edgecomputing"><span>edgecomputing</span></a>
                
                    <a href="../../../pt/search.html?query=datamanagement"><span>datamanagement</span></a>
                
                    <a href="../../../pt/search.html?query=multicloud"><span>multicloud</span></a>
                
                    <a href="../../../pt/search.html?query=zerotrust"><span>zerotrust</span></a>
                
                    <a href="../../../pt/search.html?query=process"><span>process</span></a>
                
                    <a href="../../../pt/search.html?query=technology"><span>technology</span></a>
                
            </div>

            <!-- Guests Section -->
            <div class="guests">
                
                <a href="../../../pt/guests/darren-w-pulsipher/index.html" target="_blank">Darren W Pulsipher</a>
            </div>
        </div>

        <!-- Show Notes Section -->
        <div class="show-notes">
            <h2>Detalhes da Pilha de Servi√ßos.</h2>
<p>Um cliente na ind√∫stria automotiva estava tendo dificuldades para obter efetivamente informa√ß√µes de seus carros e transferi-las para seu centro de dados, a fim de realizar aprendizado de m√°quina e an√°lises. Houve pesquisas nessa √°rea, mas apenas para um pequeno n√∫mero de carros, n√£o para os cem milh√µes de carros do cliente. Quando examinei toda a pilha de servi√ßos deles e como tudo estava sendo transferido para o centro de dados, a ingest√£o de dados tornou-se o problema claro: Como fa√ßo para absorver tantos dados e como fa√ßo isso rapidamente?</p>
<h2>Vis√£o geral da arquitetura de alto n√≠vel do Kafka.</h2>
<p>O cliente queria usar o Kafka para sua ingest√£o. O Kafka √© um corretor que pode ser dimensionado facilmente e a chave √© que ele pode lidar com diversos produtores, consumidores diferentes e muitos dados. Utilizar v√°rios corretores do Kafka para colocar e receber dados nos lugares mais apropriados oferece grande flexibilidade.</p>
<p>Kafka, no entanto, foi projetado principalmente para tamanhos de mensagem de cerca de um a 10 quilobytes e os dados do cliente eram aproximadamente 240 quilobytes por carro. Existem solu√ß√µes alternativas, mas eu queria trazer a mensagem completa de 240 quilobytes para o barramento do Kafka para que pudesse mov√™-la conforme necess√°rio.</p>
<h2>Pr√°ticas recomendadas de desempenho.</h2>
<p>Eu examinei as melhores pr√°ticas de desempenho de outras pessoas que trabalham com Kafka para ver se eu poderia dimension√°-lo para o meu cliente. Aumentar o tamanho do buffer para acomodar a mensagem inteira √© uma solu√ß√£o de ajuste fino, juntamente com o gerenciamento do tamanho do lote para um desempenho ideal. Outra pr√°tica bem-sucedida √© espalhar os logs. A flexibilidade do Kafka me permitiria colocar os dados em t√≥picos diferentes. Eu posso dividir os t√≥picos em v√°rias parti√ß√µes que eu posso distribuir em v√°rias unidades. A pergunta √©, ent√£o, em quantas unidades estou distribuindo os logs do Kafka? Al√©m disso, eu quero as unidades mais r√°pidas poss√≠veis.</p>
<p>Um exemplo que examinei foi o LinkedIn. Os n√∫meros publicados por eles h√° um ano atr√°s s√£o de que eles podem lidar com 13 milh√µes de mensagens por segundo, ou 2,7 gigabytes por segundo. Eles afirmam ter cerca de 1.100 corretores Kafka e mais de 60 em um cluster, ent√£o essa √© uma configura√ß√£o bastante grande.</p>
<h2>Espa√ßo Automotivo</h2>
<p>Se eu observar os n√∫meros brutos do cliente (1,6 milh√£o de mensagens por segundo e 800 gigabytes por segundo) e compar√°-los com o LinkedIn, que provavelmente n√£o est√° otimizado para 240 kilobytes, chego a 44.000 corretores. Se eu otimiz√°-lo, provavelmente poderia chegar a 4.400 corretores, o que ainda seriam 240 clusters. Essa √© uma quantidade enorme de m√°quinas, ent√£o eu tive que encontrar uma forma de tornar as coisas mais r√°pidas. Com mais otimiza√ß√£o, provavelmente poderia reduzir para 400 ou 500 corretores, mas eu queria ver o que mais eu poderia fazer.</p>
<h2>Intel Optane DC Persistent Memory</h2>
<p>Mem√≥ria Persistente Intel Optane DC</p>
<p>Eu olhei para nossa Mem√≥ria Persistente Optane. Ela se encaixa em um formato DDR4, ent√£o ela fica diretamente no barramento DDR4. Ela suporta m√≥dulos de at√© 512 gigabytes, ent√£o em um servidor de dois soquetes, posso ter seis terabytes de mem√≥ria persistente. Eu queria encontrar uma maneira de aproveitar essa tecnologia altamente confi√°vel com √≥timos recursos, como criptografia de hardware incorporada, para me ajudar a resolver esse problema.</p>
<h2>Suporte para uma ampla variedade de aplica√ß√µes.</h2>
<p>Existem dois modos de opera√ß√£o com este Optane Memory: modo de aplicativo direto e modo de mem√≥ria. O modo de mem√≥ria √© simples. Ele utiliza a mem√≥ria persistente como RAM normal, pois √© mais barato que o DDR4 normal. N√£o √© o mesmo que DDR4, mas √© pr√≥ximo o suficiente para que na maioria das aplica√ß√µes, voc√™ n√£o consiga perceber a diferen√ßa. No modo de aplicativo direto, voc√™ pode realmente escrever do seu programa diretamente na mem√≥ria persistente. Dessa forma, eu n√£o preciso manipular e descomprimir estruturas de dados e transmiti-las; eu posso simplesmente inseri-las na mem√≥ria persistente. Eu tamb√©m posso montar o modo de aplicativo direto como um sistema de arquivos, para que ele esteja no barramento de mem√≥ria, que √© muito mais r√°pido do que no barramento de I/O. Agora, o que posso fazer com essa mem√≥ria?</p>
<h2>Usando o Kernel do Linux</h2>
<p>Existem duas ferramentas principais dispon√≠veis usando o kernel Linux: ndctl e ipmctl. Ndctl √© um controlador de dispositivo de mem√≥ria n√£o vol√°til e depois temos o IPM, o controlador de Mem√≥ria Persistente Intel, que me permite manipular e controlar essa mem√≥ria persistente. Posso configur√°-la no modo de mem√≥ria ou no modo direto do aplicativo. Eu precisei aprender um pouco sobre essas ferramentas e como elas funcionam.</p>
<h2>Abordagem de Ingest√£o</h2>
<p>Minha primeira ideia foi que se eu fornecesse a Kafka uma quantidade maior de mem√≥ria com tamanhos de buffer grandes, ela deveria rodar muito mais r√°pido. Mudan√ßas no c√≥digo da configura√ß√£o seriam desnecess√°rias ou m√≠nimas. Outra op√ß√£o seria mudar Kafka para escrever na mem√≥ria persistente, em vez de escrever em um sistema de arquivos, contornando o disco r√≠gido. A √∫ltima coisa que eu analisei foi criar um sistema de arquivos persistente usando mem√≥ria persistente e em seguida colocar os registros do Kafka nesse novo sistema de arquivos.</p>
<p>A op√ß√£o mais f√°cil das tr√™s foi a primeira - mais mem√≥ria. Eu executei todas as minhas tarefas com mais mem√≥ria e n√£o houve mudan√ßa de desempenho. Os motivos s√£o porque eventualmente meus buffers ficaram cheios e eu tive que escrever para um disco. No final, tudo teve que ir para os registros do Kafka, que foi o gargalo.</p>
<p>A segunda op√ß√£o envolve reescrever o c√≥digo e esperar por aprova√ß√µes, ent√£o pulei para a terceira op√ß√£o. Os resultados desse experimento, onde apontei os registros para esse novo sistema de arquivos ultra-r√°pido, foram fascinantes. Vamos dar uma olhada no processo e nos resultados.</p>
<h2>Testando restri√ß√µes</h2>
<p>Para remover obst√°culos aos testes de desempenho, eu eliminei a rede da equa√ß√£o ao executar meu teste na mesma m√°quina em que meu corretor estava. Al√©m disso, eu executei apenas os produtores e depois apenas os consumidores, e s√≥ ent√£o misturei os dois, para que eu pudesse avaliar as diferen√ßas. Meu objetivo n√£o era observar uma melhoria total na produ√ß√£o, mas sim em um corretor individual para ver se esse recurso realmente faria diferen√ßa.</p>
<h2>Primeira abordagem 50/50</h2>
<p>A primeira coisa que fiz foi colocar metade da minha mem√≥ria persistente no modo direto do aplicativo e transform√°-la em um sistema de arquivos. Deixei a outra metade como mem√≥ria. Usei os comandos ndctl e ipmctl e criei namespaces. Monteis esses sistemas de arquivos e executei meu teste.</p>
<h2>Alterando o Tamanho da Mensagem</h2>
<p>Executi os testes com diferentes tamanhos de mensagens. Eu estava esperando por certa otimiza√ß√£o, principalmente para 1 kilobyte. Percebi que obtive um desempenho cada vez melhor at√© mais ou menos 10 produtores. Ap√≥s 10 produtores, comecei a saturar o barramento e obter alguma variabilidade. Isso me mostra que eu estava fazendo cache das coisas. Agora, posso comparar esses n√∫meros com o que executei antes em apenas um disco SATA para os registros do Kafka. Tamb√©m testei nossas unidades Optane NVMe para os registros.</p>
<h2>Compara√ß√£o de Tecnologia</h2>
<p>Vamos dar uma olhada nas diferen√ßas. Para 240 quilobytes, com um disco SATA normal, √© bastante uniforme. Observei alguma melhoria e, depois, diminuiu √† medida que o n√∫mero de produtores aumentava. Com o disco Optane NVMe, obtive um pico agrad√°vel, quase duas vezes mais r√°pido que um disco SATA, o que eu esperava, j√° que se trata de um barramento NVMe em vez de um barramento SATA. O Pmem √© quase cinco vezes mais r√°pido que um disco SATA e duas vezes e meia mais r√°pido que o disco Optane NVMe. Isso ocorre porque estou usando um barramento de mem√≥ria em vez do barramento SATA ou NVMe.</p>
<h2>Otimiza√ß√£o adicional (100% direto do aplicativo).</h2>
<p>Isso estava rodando r√°pido e eu estava rapidamente preenchendo essa unidade tempor√°ria de 750 GB. Como eu precisava rodar o teste um pouco mais, voltei atr√°s e reconfigurei minha m√°quina para funcionar em um modo de aplicativo 100% direto, para que agora eu possa usar o total de 1,5 terabytes.</p>
<h2>PMEM otimizado e 100% App Direct</h2>
<p>Depois de fazer isso e executar os mesmos testes, obtive um resultado surpreendente. Eu poderia adicionar mais produtores e minha taxa de transfer√™ncia aumentou quase duas ou tr√™s vezes mais. Agora est√° entre 12 e 15 vezes mais r√°pido do que uma unidade SATA com 25-30 produtores e tamanho de mensagem de 240 kilobytes. Isso √© incr√≠vel e reduziria muito a necessidade de tantos corretores, linhas e linhas de m√°quinas dos meus clientes. Executei o teste v√°rias vezes porque n√£o acreditava nos resultados que estava obtendo. Liguei para um dos nossos arquitetos que projetaram essa tecnologia e descobri que uma das raz√µes para o aumento da velocidade foi quando eu estava usando parte da mem√≥ria persistente como mem√≥ria; os dados teriam que passar por dois ou tr√™s saltos que n√£o s√£o necess√°rios com o modo de acesso direto ao aplicativo. Isso cria menos conten√ß√£o no barramento de mem√≥ria e a taxa de transfer√™ncia aumenta drasticamente.</p>
<h2>Chamada para a√ß√£o</h2>
<p>O resultado final √© que consegui usar Kafka com Mem√≥ria Persistente Optane DC como um sistema de arquivos ultrarr√°pido para obter melhorias significativas no throughput tanto para produtores quanto para consumidores. Um √∫nico corretor pode lidar com 15 vezes mais mensagens e throughput do que antes, diminuindo o n√∫mero de servidores necess√°rios para lidar com arquiteturas de sistemas grandes e complexas. √â hora de avaliar sua arquitetura atual e ver se isso seria ben√©fico para sua organiza√ß√£o.</p>

        </div>
    </div>
</section>
<footer id="footer">
    <div class="footer-content">
        <p>Copyright &copy; 2025 Paidar Productions LLC</p>
        <p>Todos os direitos reservados</p>
    </div>
</footer>
